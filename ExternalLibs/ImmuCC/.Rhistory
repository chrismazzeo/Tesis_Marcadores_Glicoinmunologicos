?probeNames
library(mouse4302mmentrezg.db)
#gene names
columns(mouse4302mmentrezg.db)
#gene names
keys(mouse4302mmentrezg.db)
columns
#gene names
columns(mouse4302mmentrezg.db)
#gene names
keys(affydata)
#gene names
keys(exprs(eset))
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
# Read all cel files under path with a custom cdf "mouse4302mmentrezcdf"
affydata <- ReadAffy(verbose=TRUE,celfile.path=celFilesDirPath, cdfname = "mouse4302mmentrezgcdf")
#gene names
keys(affydata)
# Preprocessing with frma
eset <- frma(affydata)
#gene names
keys(eset)
#gene names
probeNames(eset)
#gene names
probeNames(affydata)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC.txt"),row.names=F, col.names=F)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
# Preprocessing with frma
eset <- frma(affydata)
# Read all cel files under path with a custom cdf "mouse4302mmentrezcdf"
affydata <- ReadAffy(verbose=TRUE,celfile.path=celFilesDirPath, cdfname = "mouse4302mmentrezgcdf")
# Preprocessing with frma
eset <- frma(affydata)
#clear console
cat("\014")
#clear enviroment
rm(list=ls())
library(GEOquery)
library(affy)
library(frma)
library(mouse4302mmentrezgcdf)
library(mouse4302frmavecs)
library(preprocessCore)
library(mouse4302mmentrezg.db)
settings.geoAccessionNumber = "GSE43338"
# data folder
dir.create("data")
dataSourceDirPath = paste0("./data/",settings.geoAccessionNumber)
dir.create(dataSourceDirPath)
#results folder
resultDirPath = "./results"
dir.create(resultDirPath)
resultDirPath = paste0(resultDirPath,"/",settings.geoAccessionNumber)
dir.create(resultDirPath)
#download file
filePaths = getGEOSuppFiles(settings.geoAccessionNumber,baseDir =dataSourceDirPath)
zippedCelPath= paste0(dataSourceDirPath,"/",settings.geoAccessionNumber,"/",settings.geoAccessionNumber,"_raw.tar")
celFilesDirPath = paste0(dataSourceDirPath,"/celDir")
untar(zippedCelPath, exdir=celFilesDirPath)
# Read all cel files under path with a custom cdf "mouse4302mmentrezcdf"
affydata <- ReadAffy(verbose=TRUE,celfile.path=celFilesDirPath, cdfname = "mouse4302mmentrezgcdf")
# Preprocessing with frma
eset <- frma(affydata)
settings.geoAccessionNumber = "GSE64658"
# data folder
dir.create("data")
dataSourceDirPath = paste0("./data/",settings.geoAccessionNumber)
dir.create(dataSourceDirPath)
#results folder
resultDirPath = "./results"
dir.create(resultDirPath)
resultDirPath = paste0(resultDirPath,"/",settings.geoAccessionNumber)
dir.create(resultDirPath)
#download file
filePaths = getGEOSuppFiles(settings.geoAccessionNumber,baseDir =dataSourceDirPath)
zippedCelPath= paste0(dataSourceDirPath,"/",settings.geoAccessionNumber,"/",settings.geoAccessionNumber,"_raw.tar")
celFilesDirPath = paste0(dataSourceDirPath,"/celDir")
untar(zippedCelPath, exdir=celFilesDirPath)
# Read all cel files under path with a custom cdf "mouse4302mmentrezcdf"
affydata <- ReadAffy(verbose=TRUE,celfile.path=celFilesDirPath, cdfname = "mouse4302mmentrezgcdf")
# Preprocessing with frma
eset <- frma(affydata)
library(annotate)
#gene names
featureNames(eset)
columns(mouse4302mmentrezg.db)
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID", "SYMBOL"),
keytype = "PROBEID"
)
View(annotations)
View(featureNames(eset))
View(featureNames(eset))
ematrix = NA.omit()
ematrix = NA.omit(ematrix)
ematrix = na.omit(ematrix)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
ematrix = na.omit(ematrix)
View(ematrix)
cols =  c("GeneSymbol",colnames(ematrix))
cols
ematrix <- cbind(annotations,ematrix)
ematrix = na.omit(ematrix)
#sort by gene name
ematrix <- ematrix[order(ematrix[,1]),]
ematrix[1]
#sort by gene name
ematrix <- ematrix[order(ematrix[,2]),]
ematrix <- rbind(cols, ematrix)
# Preprocessing with frma
eset <- frma(affydata)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
#gene names
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID", "SYMBOL"),
keytype = "PROBEID"
)
cols =  c("GeneSymbol",colnames(ematrix))
ematrix <- cbind(annotations$SYMBOL,ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
#sort by gene name
ematrix <- ematrix[order(ematrix[,2]),]
ematrix <- rbind(cols, ematrix)
View(ematrix)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
cols =  c("GeneSymbol",colnames(ematrix))
ematrix <- cbind(annotations$SYMBOL,ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
#sort by gene name
ematrix <- ematrix[order(ematrix[,1]),]
ematrix <- rbind(cols, ematrix)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC.txt"),row.names=F, col.names=F)
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC.csv"))
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC.txt"),row.names=F, col.names=F)
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC.csv"))
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC.txt"),sep="\t", col.names=F, row.names=F,quote=FALSE)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC.txt"),sep="\t", col.names=F, row.names=F,quote=FALSE)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC.txt"),sep="\t", col.names=F, row.names=F,quote=FALSE)
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC.csv"))
#gene names
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID", "SYMBOL"),
keytype = "PROBEID"
)
cols =  c("GeneSymbol",colnames(ematrix))
ematrix <- cbind(annotations$SYMBOL,ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
#sort by gene name
ematrix <- ematrix[order(ematrix[,1]),]
ematrix <- rbind(cols, ematrix)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F, row.names=F,quote=FALSE)
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC_CS.csv"))
keys(annotations)
columns(annotations)
#gene names
columns(mouse4302mmentrezg.db)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC.txt"),sep="\t", col.names=F, row.names=F,quote=FALSE)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F, row.names=F,quote=FALSE)
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC.csv"))
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC_CS.csv"))
# Read all cel files under path with a custom cdf "mouse4302mmentrezcdf"
affydata <- ReadAffy(verbose=TRUE,celfile.path=celFilesDirPath, cdfname = "mouse4302mmentrezgcdf")
# Preprocessing with frma
eset <- frma(affydata)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC.txt"),sep="\t", col.names=F, row.names=F,quote=FALSE)
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC.csv"))
#gene names
columns(mouse4302mmentrezg.db)
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("ENTREZID", "SYMBOL"),
keytype = "ENTREZID"
)
cols =  c("GeneSymbol",colnames(ematrix))
ematrix <- cbind(annotations$SYMBOL,ematrix)
#gene names
columns(mouse4302mmentrezg.db)
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID", "SYMBOL"),
keytype = "ENTREZID"
)
#gene names
columns(mouse4302mmentrezg.db)
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID", "SYMBOL"),
keytype = "PROBEID"
)
cols =  c("GeneSymbol",colnames(ematrix))
ematrix <- cbind(annotations$SYMBOL,ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
#sort by gene name
ematrix <- ematrix[order(ematrix[,1]),]
ematrix <- rbind(cols, ematrix)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F, row.names=F,quote=FALSE)
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC_CS.csv"))
mouse4302mmentrezg$probeid
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F, quote=FALSE)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC.txt"),sep="\t", col.names=F, quote=FALSE)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC2.txt"),sep="\t", col.names=F, row.names=F,quote=FALSE)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F,row.names=F quote=FALSE) #OK pero no anda
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F,row.names=F ,quote=FALSE) #OK pero no anda
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F,row.names=F ,quote=FALSE) #OK pero no anda
# Read all cel files under path with a custom cdf "mouse4302mmentrezcdf"
affydata <- ReadAffy(verbose=TRUE,celfile.path=celFilesDirPath, cdfname = "mouse4302mmentrezgcdf")
# Preprocessing with frma
eset <- frma(affydata)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
#entreIZ
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC.txt"), col.names=F, row.names=F) #OK pero no anda
View(ematrix)
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC.csv")) #OK pero no anda
#gene names
columns(mouse4302mmentrezg.db)
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID", "SYMBOL","ENTREZID"),
keytype = "PROBEID"
)
View(annotations)
#probeID
featureNames(eset)
#diferentes ids from db
columns(mouse4302mmentrezg.db)
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID", "SYMBOL","ENTREZID"),
keytype = "PROBEID"
)
cols =  c("GeneSymbol",colnames(ematrix))
ematrix <- cbind(annotations$ENTREZID,ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
#sort by gene name
ematrix <- ematrix[order(ematrix[,1]),]
ematrix <- rbind(cols, ematrix)
View(ematrix)
ematrix <- cbind(annotations$ENTREZID,ematrix)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
cols =  c("GeneSymbol",colnames(ematrix))
ematrix <- cbind(annotations$ENTREZID,ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
cols =  c("GeneSymbol",colnames(ematrix))
ematrix <- cbind(annotations$ENTREZID,ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
View(annotations)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F,row.names=F ,quote=FALSE) #OK pero no anda
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC_CS.csv"))#OK pero no anda
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F,row.names=F ,quote=FALSE) #OK pero no anda
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC_CS.csv"))#OK pero no anda
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F,row.names=F ,quote=FALSE) #OK pero no anda
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC_CS.csv"))#OK pero no anda
ematrix <- rbind(cols, ematrix)
View(matrix)
View(emacs())
View(ematrix)
length(annotations$ENTREZID)
rownames(ematrix) = annotations$ENTREZID
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
View(ematrix)
rownames(ematrix)
annotations$ENTREZID
rownames(ematrix)
annotations$ENTREZID
rownames(ematrix) = annotations$ENTREZID
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
#probeID de ENTREZ
featureNames(eset)
#probeID de ENTREZ
featureNames(eset)
#diferentes ids from db
columns(mouse4302mmentrezg.db)
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID","ENTREZID", "SYMBOL"),
keytype = "PROBEID"
)
#cols =  c("GeneSymbol",colnames(ematrix))
#ematrix <- cbind(annotations$ENTREZID,ematrix)
rownames(ematrix) = annotations$ENTREZID
View(ematrix)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
#probeID de ENTREZ
featureNames(eset)
#diferentes ids from db
columns(mouse4302mmentrezg.db)
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID","ENTREZID", "SYMBOL"),
keytype = "PROBEID"
)
ematrix <- cbind(annotations$ENTREZID,ematrix)
View(ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
#assign rownames
rownames(ematrix) = annotations$ENTREZID
annotations$ENTREZID
View(annotations$ENTREZID)
#assign rownames
annotations$ENTREZID = na.omit(annotations$ENTREZID)
#assign rownames
ENTREZID = na.omit(annotations$ENTREZID)
rownames(ematrix) = ENTREZID
#remove first column
ematrix = ematrix[-1,]
View(ematrix)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
#probeID de ENTREZ
featureNames(eset)
#diferentes ids from db
columns(mouse4302mmentrezg.db)
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID","ENTREZID", "SYMBOL"),
keytype = "PROBEID"
)
ematrix <- cbind(annotations$ENTREZID,ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
#assign rownames
ENTREZID = na.omit(annotations$ENTREZID)
rownames(ematrix) = ENTREZID
#remove first column
ematrix = ematrix[,-1]
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"),sep="\t", col.names=F,row.names=F ,quote=FALSE) #OK pero no anda
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC_CS.csv"))
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt")) #OK pero no anda
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt")) #OK pero no anda
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"))
#clear console
cat("\014")
#clear enviroment
rm(list=ls())
library(GEOquery)
library(affy)
library(frma)
library(mouse4302mmentrezgcdf)
library(mouse4302frmavecs)
library(preprocessCore)
library(annotate)
library(mouse4302mmentrezg.db)
settings.geoAccessionNumber = "GSE43338"
# data folder
dir.create("data")
dataSourceDirPath = paste0("./data/",settings.geoAccessionNumber)
dir.create(dataSourceDirPath)
#results folder
resultDirPath = "./results"
dir.create(resultDirPath)
resultDirPath = paste0(resultDirPath,"/",settings.geoAccessionNumber)
dir.create(resultDirPath)
#download file
filePaths = getGEOSuppFiles(settings.geoAccessionNumber,baseDir =dataSourceDirPath)
zippedCelPath= paste0(dataSourceDirPath,"/",settings.geoAccessionNumber,"/",settings.geoAccessionNumber,"_raw.tar")
celFilesDirPath = paste0(dataSourceDirPath,"/celDir")
untar(zippedCelPath, exdir=celFilesDirPath)
# Read all cel files under path with a custom cdf "mouse4302mmentrezcdf"
affydata <- ReadAffy(verbose=TRUE,celfile.path=celFilesDirPath, cdfname = "mouse4302mmentrezgcdf")
# Preprocessing with frma
eset <- frma(affydata)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
#probeID de ENTREZ
featureNames(eset)
#diferentes ids from db
columns(mouse4302mmentrezg.db)
annotations <- AnnotationDbi::select(
x       = mouse4302mmentrezg.db,
keys    = featureNames(eset),
columns = c("PROBEID","ENTREZID", "SYMBOL"),
keytype = "PROBEID"
)
ematrix <- cbind(annotations$ENTREZID,ematrix)
#remove id with out gene symbol
ematrix = na.omit(ematrix)
#assign rownames
ENTREZID = na.omit(annotations$ENTREZID)
rownames(ematrix) = ENTREZID
#remove first column
ematrix = ematrix[,-1]
ematrix <- rbind(cols, ematrix)
write.table(ematrix,  paste0(settings.geoAccessionNumber,"ImmuCC_CS.txt"))
write.csv(ematrix,paste0(settings.geoAccessionNumber,"ImmuCC_CS.csv"))
# Read all cel files under path with a custom cdf "nmouse4302mmentrezcdf"
affydata <- ReadAffy(verbose=TRUE,celfile.path=path,cdfname = "mouse4302mmentrezgcdf")
#clear console
cat("\014")
#clear enviroment
rm(list=ls())
library(GEOquery)
library(affy)
library(frma)
library(mouse4302mmentrezgcdf)
library(mouse4302frmavecs)
library(preprocessCore)
library(annotate)
library(mouse4302mmentrezg.db)
settings.geoAccessionNumber = "GSE43338"
# data folder
dir.create("data")
dataSourceDirPath = paste0("./data/",settings.geoAccessionNumber)
dir.create(dataSourceDirPath)
#results folder
resultDirPath = "./results"
dir.create(resultDirPath)
resultDirPath = paste0(resultDirPath,"/",settings.geoAccessionNumber)
dir.create(resultDirPath)
#download file
filePaths = getGEOSuppFiles(settings.geoAccessionNumber,baseDir =dataSourceDirPath)
zippedCelPath= paste0(dataSourceDirPath,"/",settings.geoAccessionNumber,"/",settings.geoAccessionNumber,"_raw.tar")
celFilesDirPath = paste0(dataSourceDirPath,"/celDir")
untar(zippedCelPath, exdir=celFilesDirPath)
# Read all cel files under path with a custom cdf "mouse4302mmentrezcdf"
affydata <- ReadAffy(verbose=TRUE,celfile.path=celFilesDirPath, cdfname = "mouse4302mmentrezgcdf")
# Preprocessing with frma
eset <- frma(affydata)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
#probeID de ENTREZ
featureNames(eset)
#diferentes ids from db
columns(mouse4302mmentrezg.db)
# Preprocessing with frma
eset <- frma(affydata)
# Output the expression value of samples profiled on array
ematrix <- exprs(eset)
#probeID de ENTREZ
featureNames(eset)
eset
# Preprocessing with frma
eset <- frma(affydata)
#clear console
cat("\014")
#clear enviroment
rm(list=ls())
library(GEOquery)
library(affy)
library(frma)
library(mouse4302mmentrezgcdf)
library(mouse4302frmavecs)
library(preprocessCore)
library(annotate)
library(mouse4302mmentrezg.db)
settings.geoAccessionNumber = "GSE43338"
# data folder
dir.create("data")
dataSourceDirPath = paste0("./data/",settings.geoAccessionNumber)
dir.create(dataSourceDirPath)
#results folder
resultDirPath = "./results"
dir.create(resultDirPath)
resultDirPath = paste0(resultDirPath,"/",settings.geoAccessionNumber)
dir.create(resultDirPath)
#download file
filePaths = getGEOSuppFiles(settings.geoAccessionNumber,baseDir =dataSourceDirPath)
zippedCelPath= paste0(dataSourceDirPath,"/",settings.geoAccessionNumber,"/",settings.geoAccessionNumber,"_raw.tar")
celFilesDirPath = paste0(dataSourceDirPath,"/celDir")
untar(zippedCelPath, exdir=celFilesDirPath)
celFilesDirPath
# Read all cel files under path with a custom cdf "mouse4302mmentrezcdf"
affydata <- ReadAffy(verbose=TRUE,celfile.path=celFilesDirPath, cdfname = "mouse4302mmentrezgcdf")
# Preprocessing with frma
eset <- frma(affydata)
affydata
featureNames(affydata)
affydata
# Preprocessing with frma
eset <- frma(affydata)
